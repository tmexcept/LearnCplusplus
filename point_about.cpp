//
// Created by hu on 2023/9/10.
//

#include "point_about.h"

using namespace std;

void point_about::testPointAdd(){
    //æ‰“å°ç»“æœå¦‚ä¸‹ï¼š
    //a = 123456ï¿½ï¿½{ï¿½,  p=2076178434, *p=1
    //a = 123456ï¿½ï¿½{ï¿½,  p=2076178438, *p=5
    //a = 123456789aï¿½ï¿½ï¿½ï¿½,  p=-778046194, *p=1
    //a = 123456789aï¿½ï¿½ï¿½ï¿½,  p=-778046190, *p=5
    char a[10] = {'1', '2', '3', '4', '5', '6', '7', '8', '9', 'a'};
    int *p = reinterpret_cast<int *>(a);
    printf("a = %s,  p=%d, *p=%c\n", a, p, *p);
    p++;
    printf("a = %s,  p=%d, *p=%c\n", a, p, *p);
//    char* m = &a;


    int a1=12;
    int b;
    int *p1;
    int **ptr;
    p1=&a1;//&açš„ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œç±»å‹æ˜¯int*ï¼ŒæŒ‡å‘çš„ç±»å‹æ˜¯intï¼ŒæŒ‡å‘çš„åœ°å€æ˜¯açš„åœ°å€ã€‚
    *p1=24;//*pçš„ç»“æœï¼Œåœ¨è¿™é‡Œå®ƒçš„ç±»å‹æ˜¯intï¼Œå®ƒæ‰€å ç”¨çš„åœ°å€æ˜¯pæ‰€æŒ‡å‘çš„åœ°å€ï¼Œæ˜¾ç„¶ï¼Œ*på°±æ˜¯å˜é‡aã€‚
    printf("a1=%d,  p1=%d, *p1=%d\n", a1, p1, *p1);
    ptr=&p1;//&pçš„ç»“æœæ˜¯ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆçš„ç±»å‹æ˜¯pçš„ç±»å‹åŠ ä¸ª*ï¼Œåœ¨è¿™é‡Œæ˜¯int**ã€‚è¯¥æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯pçš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯int*ã€‚è¯¥æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€å°±æ˜¯æŒ‡é’ˆpè‡ªå·±çš„åœ°å€ã€‚
    *ptr=&b;//*ptræ˜¯ä¸ªæŒ‡é’ˆï¼Œ&bçš„ç»“æœä¹Ÿæ˜¯ä¸ªæŒ‡é’ˆï¼Œä¸”è¿™ä¸¤ä¸ªæŒ‡é’ˆçš„ç±»å‹å’Œæ‰€æŒ‡å‘çš„ç±»å‹æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥?amp;bæ¥ç»™*ptrèµ‹å€¼å°±æ˜¯æ¯«æ— é—®é¢˜çš„äº†ã€‚
    **ptr=34;//*ptrçš„ç»“æœæ˜¯ptræ‰€æŒ‡å‘çš„ä¸œè¥¿ï¼Œåœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå¯¹è¿™ä¸ªæŒ‡é’ˆå†åšä¸€æ¬¡*è¿ç®—ï¼Œç»“æœå°±æ˜¯ä¸€ä¸ªintç±»å‹çš„å˜é‡ã€‚
    printf("a1=%d,  p1=%d, *p1=%d\n", a1, p1, *p1);
    printf("*prt=%d,  **prt=%d\n", *ptr, **ptr);
}

//todo å¸¸é‡æŒ‡é’ˆè¯´çš„æ˜¯ä¸èƒ½é€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ”¹å˜å˜é‡çš„å€¼ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥é€šè¿‡å…¶ä»–çš„å¼•ç”¨æ¥æ”¹å˜å˜é‡çš„å€¼çš„
// å¸¸é‡æŒ‡é’ˆæŒ‡å‘çš„å€¼ä¸èƒ½æ”¹å˜ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯æ„å‘³ç€æŒ‡é’ˆæœ¬èº«ä¸èƒ½æ”¹å˜ï¼Œå¸¸é‡æŒ‡é’ˆå¯ä»¥æŒ‡å‘å…¶ä»–çš„åœ°å€ã€‚

void point_about::testConstPoint() {
    int aa = 10;
    int *pp = &aa;
    *pp = 20;//ä¿®æ”¹æŒ‡é’ˆæŒ‡å‘çš„å€¼
//    int ppp = &aa;//é”™è¯¯ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæŒ‡é’ˆ
    int i = 5;
    int j = 6;
    int k = 7;
    const int * p1 = &i; //å®šä¹‰1
    int * const p2 =&j; //å®šä¹‰2
    //ä¸Šé¢å®šä¹‰äº†ä¸¤ä¸ªæŒ‡é’ˆp1å’Œp2ã€‚
    //åœ¨å®šä¹‰1ä¸­consté™å®šçš„æ˜¯*p1ï¼Œå³å…¶æŒ‡å‘ç©ºé—´çš„å€¼ä¸å¯æ”¹å˜ï¼Œè‹¥æ”¹å˜å…¶æŒ‡å‘ç©ºé—´çš„å€¼å¦‚*p1=20ï¼Œåˆ™ç¨‹åºä¼šæŠ¥é”™ï¼›
    //  ä½†p1çš„å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œå¯¹p1é‡æ–°èµ‹å€¼å¦‚p1=&kæ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ã€‚
    //åœ¨å®šä¹‰2ä¸­consté™å®šçš„æ˜¯æŒ‡é’ˆp2ï¼Œè‹¥æ”¹å˜p2çš„å€¼å¦‚p2=&kï¼Œç¨‹åºå°†ä¼šæŠ¥é”™ï¼›
    //  ä½†*p2ï¼Œå³å…¶æ‰€æŒ‡å‘ç©ºé—´çš„å€¼å¯ä»¥æ”¹å˜ï¼Œå¦‚*p2=80æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œç¨‹åºæ­£å¸¸æ‰§è¡Œã€‚

    int a = 10;
    const int *p = &a;
    printf("a = %d,  *p=%d\n", a, *p);
    int b = 40;
    //*p = 30;  //è¿™ä¹ˆå†™å°±æ˜¯é”™çš„
    p = &b;//ä¿®æ”¹äº†pæŒ‡å‘çš„å€¼ï¼Œä¸ä¼šä¿®æ”¹açš„å€¼ï¼›
    printf("a = %d,  *p=%d\n", a, *p);

//todo æŒ‡é’ˆå¸¸é‡æ˜¯æŒ‡æŒ‡é’ˆæœ¬èº«æ˜¯ä¸ªå¸¸é‡ï¼Œä¸èƒ½åœ¨æŒ‡å‘å…¶ä»–çš„åœ°å€;
// æŒ‡é’ˆå¸¸é‡æŒ‡å‘çš„åœ°å€ä¸èƒ½æ”¹å˜ï¼Œä½†æ˜¯åœ°å€ä¸­ä¿å­˜çš„æ•°å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œå¯ä»¥é€šè¿‡å…¶ä»–æŒ‡å‘æ”¹åœ°å€çš„æŒ‡é’ˆæ¥ä¿®æ”¹
    int * const q = &a;
    *q = 20;
    printf("a = %d\n", a);
    a = 30;
    printf("a = %d,  *p=%d\n", a, *p);
    //è¾“å‡ºç»“æœæ˜¯ï¼š
    //a = 20
    //a = 30
}

int a = 4;
int aa= 4;

int &f(int x) {
    a = a + x;
    return a;
}
int ff(int x) {
    aa = aa + x;
    return aa;
}


void point_about::testModifyArgument(){
    int t = 5;
    cout << f(t) << endl;  //a = 9
    f(t) = 20;           //a = 20
    cout << f(t) << endl;  //t = 5,a = 20  a = 25
    t = f(t);            //a = 30 t = 30
    cout << f(t) << endl;  //t = 60
    cout << "###############" << endl;

    int t1 = 5;
    cout << ff(t1) << endl;  //a = 9
//    ff(t) = 20;           //a = 20
//    cout << ff(t1) << endl;  //t = 5,a = 20  a = 25
    t1 = ff(t1);            //a = 30 t = 30
    cout << ff(t1) << endl;  //t = 60
    cout << "###############" << endl;
}

/**
 * a=10,  &a=-81790976  *p=10  p=-81790976
 * a=20,  &a=-81790976  *p=20  p=-81790976
 * &(*p)=729807160,  *(&p)=729807160
 * *p10=20
   *p11=20
 * (unsigned int 10) + (int -20) <= 5
 */
void point_about::initPoint() {
    //æŒ‡é’ˆæ˜¯ä¸€ä¸ªå˜é‡;
    unsigned int a = 10;
    //&pæ˜¯æŒ‡é’ˆçš„åœ°å€ï¼Œç”¨æ¥å­˜æ”¾æŒ‡é’ˆpï¼Œè€ŒæŒ‡é’ˆpæ¥å­˜æ”¾å˜é‡açš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯&aï¼Œ
    //*påœ¨Cè¯­è¨€ä¸­æ˜¯è§£å¼•ï¼Œæ„æ€æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨å–å‡ºè¯¥åœ°å€å­˜æ”¾çš„å†…å®¹
    unsigned int *p = NULL;//æŒ‡é’ˆæ˜¯ä¸€ä¸ªå˜é‡  é’ˆå¯¹32ä½ç¼–è¯‘å™¨è€Œè¨€ï¼Œæ—¢ç„¶ä»»ä½•æŒ‡é’ˆéƒ½åªå ç”¨4ä¸ªå­—èŠ‚
    p = &a;
    printf("a=%d,  &a=%d  *p=%d  p=%d\n",a,&a,*p, p);
    *p = 20;
    printf("a=%d,  &a=%d  *p=%d  p=%d\n",a,&a,*p, p);
    printf("&(*p)=%d,  *(&p)=%d\n",&(*p), *(&p));

    int *pd = reinterpret_cast<int *>(a);
    unsigned int *p10 = &a;//å¿…é¡»ä½¿ç”¨ unsignedï¼Œ å¦åˆ™æŠ¥é”™
    printf("*p10=%d\n",*p10);//æ­¤å¤„ä¸èƒ½ç›´æ¥è°ƒç”¨ **p10;
    unsigned int **p11 = &p10;//æŒ‡é’ˆçš„æŒ‡é’ˆ  å¿…é¡»ä½¿ç”¨ unsignedï¼Œ å¦åˆ™æŠ¥é”™
    printf("*p11=%dï¼Œ **p11=&d\n",*p11,**p11);

//    ä»¥ä¸‹ä»£ç æœ‰å¯èƒ½å‡ºé—®é¢˜ï¼Œæ‰€ä»¥è¿è¡Œæ—¶æ³¨æ‰äº†
//    unsigned int *p1=(unsigned int*)(6422216);//å¯¹å†…å­˜6422216ä¸­å¡«å…¥ä¸€ä¸ªæ•°æ®125  todo æ‰€æœ‰å†…å­˜åœ°å€ä¸èƒ½éšä¾¿æŒ‡å®šï¼Œå¿…é¡»æ˜¯è®¡ç®—æœºå·²ç»åˆ†é…çš„å†…å­˜ï¼Œå¦åˆ™è®¡ç®—æœºä¼šè®¤ä¸ºæŒ‡é’ˆè¶Šç•Œè€Œè¢«æ“ä½œç³»ç»Ÿæ€æ­»å³ç¨‹åºæå‰ç»ˆæ­¢ã€‚
//    *p1=125;//*påœ¨Cè¯­è¨€ä¸­æ˜¯è§£å¼•ï¼Œæ„æ€æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨å–å‡ºè¯¥åœ°å€å­˜æ”¾çš„å†…å®¹
//    *(unsigned int*)(6422216)=125;//ä¸ä¸Šä¸€æ®µä»£ç ç»“æœä¸€æ ·ï¼Œ
//    int *p2 = (int *)(0xff96);//è·å–å†…å­˜åœ°å€ 0xff96 æŒ‡é’ˆ

    int b = -20;
    a + b > 0 ? printf("(unsigned int 10) + (int -20) > 5\n") : printf("(unsigned int 10) + (int -20) <= 5\n");
}



// todo void æŒ‡é’ˆ
//åœ¨å¾ˆå¤šæ—¶å€™æŒ‡é’ˆåœ¨ç”³æ˜çš„æ—¶å€™å¯èƒ½å¹¶ä¸çŸ¥é“æ˜¯ä»€ä¹ˆç±»å‹æˆ–è€…è¯¥æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ç±»å‹æœ‰å¤šç§å†æˆ–è€…ç¨‹åºå‘˜ä»…ä»…æ˜¯æƒ³é€šè¿‡ä¸€ä¸ªæŒ‡é’ˆæ¥æ“ä½œä¸€æ®µå†…å­˜ç©ºé—´ã€‚
// è¿™ä¸ªæ—¶å€™å¯ä»¥å°†æŒ‡é’ˆç”³æ˜ä¸ºvoidç±»å‹
//ç”±äºvoidæŒ‡é’ˆæ²¡æœ‰ç©ºé—´å¤§å°å±æ€§ï¼Œå› æ­¤voidæŒ‡é’ˆä¹Ÿæ²¡æœ‰++æ“ä½œã€‚  ä¸å…·æœ‰è§£å¼•æ—¶çš„ç©ºé—´å¤§å°
void void_reference_test(){
    int a=10;
    void *p;
    p=&a;
    printf("p=%d\n",*(int*)p/*  *p   */);//todo æ­¤å¤„å¿…é¡»åšæ•°æ®ç±»å‹è½¬æ¢
}

//todo  ç»“æ„ä½“æŒ‡é’ˆ
typedef struct STUDENT
{
    int      name;
    int    gender;
    long  test;
    char char_a;
}stu;
//å˜é‡çš„å®šä¹‰æœ€å¥½æ·»åŠ å‰é™å®šåï¼Œæ¯”å¦‚æ­¤å¤„å¦‚æœå†™ a ï¼Œä¼šä¸å…¶ä»– cpp ä¸­çš„aå†²çª
int int_array_a[]={10,20,30,0xffffff,50};
void structCast()
{
    stu *student;
    student=(stu*)int_array_a;
    /**
     *  student->name=10
        student->gender=20
        student->test=30
        student->char_a=-1
     */
    printf("student->name=%d\n",student->name);
    printf("student->gender=%d\n",student->gender);
    printf("student->test=%d\n",student->test);
    printf("student->char_a=%d\n",student->char_a);
}

//todo å‡½æ•°æŒ‡é’ˆ
//å‡½æ•°æŒ‡é’ˆçš„è§£å¼•æ“ä½œä¸æ™®é€šçš„æŒ‡é’ˆæœ‰ç‚¹ä¸ä¸€æ ·ï¼Œå¯¹äºæ™®é€šçš„æŒ‡é’ˆè€Œè¨€ï¼Œè§£å¼•åªéœ€è¦æ ¹æ®ç±»å‹æ¥å–å‡ºæ•°æ®å³å¯;
// ä½†å‡½æ•°æŒ‡é’ˆæ˜¯è¦è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå…¶è§£å¼•ä¸å¯èƒ½æ˜¯å°†æ•°æ®å–å‡ºï¼Œå®é™…ä¸Šå‡½æ•°æŒ‡é’ˆçš„è§£å¼•æœ¬è´¨ä¸Šæ˜¯æ‰§è¡Œå‡½æ•°çš„è¿‡ç¨‹ï¼Œ
// åªæ˜¯è¿™ä¸ªæ‰§è¡Œå‡½æ•°æ˜¯ä½¿ç”¨çš„callæŒ‡ä»¤å¹¶ä¸æ˜¯ä¹‹å‰çš„å‡½æ•°ï¼Œè€Œæ˜¯å‡½æ•°æŒ‡é’ˆçš„å€¼ï¼Œ
// å³å‡½æ•°çš„åœ°å€ã€‚å…¶å®æ‰§è¡Œå‡½æ•°çš„è¿‡ç¨‹æœ¬è´¨ä¸Šä¹Ÿæ˜¯åˆ©ç”¨callæŒ‡ä»¤æ¥è°ƒç”¨å‡½æ•°çš„åœ°å€ï¼Œå› æ­¤å‡½æ•°æŒ‡é’ˆæœ¬è´¨ä¸Šå°±æ˜¯ä¿å­˜å‡½æ•°æ‰§è¡Œè¿‡ç¨‹çš„é¦–åœ°å€
typedef struct TFT_DISPLAY
{
    int   pix_width;
    int   pix_height;
    int   color_width;
    void (*init)(void);
    void (*fill_screen)(int color);
    void (*tft_test)(void);

}tft_display;

static void init(void)
{
    printf("the display is initialed\n");
}

static void fill_screen(int color)
{
    printf("the display screen set 0x%x\n",color);
}

tft_display mydisplay=
        {
                .pix_width=320,
                .pix_height=240,
                .color_width=24,
                .init=init,
                .fill_screen=fill_screen,
        };

void point_test_function_reference()
{

    mydisplay.init();
    mydisplay.fill_screen(0xfff);
}